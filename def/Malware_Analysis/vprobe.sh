# !/bin/bash 
# Description: A first contact analysis script to be used on suspicious files, provides user with the following info.: 
# --1.magic number, 2.file architecture(32 or 64 bit), 3.endianess, 4.default option
#
# Usage: vprobe.sh <opt> <suspect-file> OR vprobe.sh <suspect-file> 

sus_file=$2

while getopts 'mfe:*' opt
do 
        case $opt in 
                m) #OBTAIN MAGIC NUM
                        printf "MAGIC NUM: "
                        hexdump -s 0 -n 4 $2
                ;;

                f) #OBTAIN FILE ARCHITECTURE
                        printf "FILE-ARCH: "
                        hexdump -s 4 -n 1 $2
                ;;

                e) #OBTAIN ENDIANESS
                        printf "ENDIAN:  " 
                        hexdump -s 5 -n 1 $2 
                ;;

                *) #EITHER DEFAULT OPTION TRIGGERED 
                        echo "ERROR(!) option not availavle." 
                ;;
        esac
done

# need to create a case  that will work if $1=" " 
# for example IF $1=' ' perfom total probe. 

# (!) NEED TO ADD STRING EXTRACTION CAPABILITY 
# String extractiom 
# search bunary for single-printable chars sep. by non-printable char., where '.' is the non-print char
# egrep -a -o -i '\.*\b[[:print:]]{1}\.[[:print:]]*\b' <suspect_file> 
# find ^ a way to for a printable char 
# ergrep -v -a -o -i  \.*\b[[:print:]]{1}\.[[:print:]]*\b' <suspect_file>  
